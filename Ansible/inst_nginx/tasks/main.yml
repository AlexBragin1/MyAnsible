---
 
- name: Intstall Nginx Web Server on RedHat 
  yum:
     name: nginx
     update_cache: yes
     state: present
  when: ansible_os_family =="RedHat"
  notify:
    - nginx start 

- name: "Check if NGINX is installed"
  package_facts:
     manager: "auto"

- name: Install Nginx Web Server on  Debian
  apt:
     name:  nginx
     state: present 
  when: "'nginx' not in ansible_facts.packages and ansible_os_family =='Debian'"
  notify: 
    - nginx start 

- name: Create home directory for www
  file:
    path: /var/www/{{ virtual_domain }}
    state: directory 

- name: Replace nginx.conf
  template:
    src=/home/kroot/My_program/Ansible/inst_nginx/file/nginx.conf
    dest=/etc/nginx/nginx.conf

- name: Add virtual domain in NGINX for RPM
  template:
    src=/home/kroot/My_program/Ansible/inst_nginx/file/nginx.conf
    dest=/etc/nginx/nginx.conf
  when:
    ansible_os_family == "RedHat"
  notify:
    - nginx restart
